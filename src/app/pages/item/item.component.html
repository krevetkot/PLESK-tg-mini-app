<div class="item-container">
  <!-- Карусель изображений -->
  <div class="carousel-container"
       (touchstart)="onTouchStart($event)"
       (touchmove)="onTouchMove($event)"
       (touchend)="onTouchEnd($event)">

    <div class="carousel-slide">
      <img
        [src]="currentImage"
        alt="Нет фото"
        loading="lazy"
        class="carousel-image"
      >
    </div>

    @if (productImages.length > 1) {
    <button class="carousel-btn prev" (click)="prevImage()">‹</button>
    <button class="carousel-btn next" (click)="nextImage()">›</button>

    <div class="carousel-indicators">
        @for (img of productImages; track $index; let i = $index) {
    <button
      class="indicator"
      [class.active]="currentImageIndex === i"
      (click)="goToImage(i)"
    ></button>
    }
    </div>
    }
  </div>


  <div class="product-info">
    <h2 class="product-name">{{ product.name }}</h2>
    <div class="product-price">
      {{ product.price }} ₽
    </div>
    <p class="product-description">{{product.description}}</p>

    <div class="specs-container">
      <h3 class="specs-title">Характеристики</h3>
      <table class="item-info-table">
        <tbody>
        <tr>
          <td class="left-column">Страна производитель:</td>
          <td class="right-column">{{product.madeIn}}</td>
        </tr>
        <tr>
          <td class="left-column">В наличии:</td>
          <td class="right-column">{{product.count >= 1000 ? 'Много' : product.count + ' шт.'}}</td>
        </tr>
        <tr [hidden]="product.countInPack === 0">
          <td class="left-column">Количество в коробке:</td>
          <td class="right-column">{{product.countInPack}} шт.</td>
        </tr>
        <tr>
          <td class="left-column">Артикул:</td>
          <td class="right-column">{{product.article}}</td>
        </tr>
        </tbody>
      </table>
    </div>

      <div class="add-btns-container">
        <!-- Левая кнопка (1 шт) -->
        @if (addedQuantity === 0) {
        <button class="add-to-cart-1-item-btn" (click)="addToCart(1)" [disabled]="product.count === 0">
        {{ product.count === 0 ? 'Нет в наличии' : 'Добавить 1 шт.' }}
        </button>
        } @else {
        <div class="quantity-controls">
          <button class="quantity-btn minus" (click)="decreaseQuantity()">
            −
          </button>
          <span class="quantity-display">{{ addedQuantity }} шт.</span>
            <button class="quantity-btn plus" (click)="increaseQuantity()"
                    [disabled]="addedQuantity >= product.count">
              +
            </button>
          </div>
        }

        <!-- Правая кнопка (1 кор) -->
        <button class="add-to-cart-1-box-btn" (click)="addToCart(product.countInPack)" [disabled]="product.count === 0" [hidden]="product.countInPack === 0">
          {{ product.count === 0 ? 'Нет в наличии' : 'Добавить 1 кор.' }}
        </button>
      </div>

    <div>
      @if (addedQuantity !== 0) {
        <button class="go-to-cart-button" (click)="navigateToCart()">
          Перейти в корзину
        </button>
      }
    </div>
  </div>
</div>
